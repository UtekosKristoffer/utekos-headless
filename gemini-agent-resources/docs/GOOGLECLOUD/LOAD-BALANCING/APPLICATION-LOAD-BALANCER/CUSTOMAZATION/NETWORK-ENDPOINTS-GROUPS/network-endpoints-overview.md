# Network endpoint groups overview

A network endpoint group (NEG) is a configuration object that specifies a group
of backend endpoints or services. With NEGs, Google Cloud load balancers can
serve virtual machine (VM) instance group-based workloads, serverless workloads,
and containerized workloads. NEGs let you distribute traffic to your load
balancer's backends at a more granular level (for example, load balancing
traffic at the Pod level instead of at the VM-level for GKE workloads).

You can configure NEGs as backends for your load balancers. Certain NEG types
can also be used with Cloud Service Mesh. Use the following tables to decide
which type of NEG you need for your deployment.

- [Zonal NEG](#zonal-neg)
- [Internet NEG](#internet-neg)
- [Serverless NEG](#serverless-neg)
- [Hybrid connectivity NEG](#hybrid-connectivity-neg)
- [Private Service Connect NEG](#private-service-connect-neg)
- [Port mapping NEG](#port-mapping-neg)

---

## Zonal NEG

| Features                                    | Details                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| :------------------------------------------ | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Purpose**                                 | One or more internal IP address endpoints that resolve to either Compute Engine VM instances or GKE Pods.<br>For detailed information, see [Zonal NEGs overview](https://cloud.google.com/load-balancing/docs/negs/zonal-neg-concepts).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **NetworkEndpointType API name**            | `GCE_VM_IP`<br>IP only: resolves to the primary internal IPv4 address of a VM's network interface.<br><br>OR<br><br>`GCE_VM_IP_PORT`<br>IP:Port: resolves to either the primary internal IPv4 address of a VM's network interface or an internal IPv4 address from an alias IP address range; for example, Pod IPv4 addresses in VPC-native clusters.<br>Only `GCE_VM_IP_PORT` type endpoints support IPv4 and IPv6 (dual stack) zonal NEGs.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **Number of endpoints**                     | 1 or more                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| **Health checks**                           | Centralized health checks for NEGs with `GCE_VM_IP_PORT` and `GCE_VM_IP` endpoints.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **Scope**                                   | Zonal                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Routing**                                 | VPC network                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **Google Cloud products that use this NEG** | _ **Internal passthrough Network Load Balancer** (`GCE_VM_IP` endpoints):<br> _ [Set up zonal NEGs for internal passthrough Network Load Balancers](https://cloud.google.com/load-balancing/docs/l4-internal/setting-up-zonal-negs)<br> _ **External passthrough Network Load Balancer** (`GCE_VM_IP` endpoints):<br> _ [Set up zonal NEGs for external passthrough Network Load Balancers](https://cloud.google.com/load-balancing/docs/l4-external/setting-up-zonal-negs)<br> _ **Regional internal proxy Network Load Balancer** (`GCE_VM_IP_PORT` endpoints)<br> _ [Set up zonal NEGs for regional internal proxy Network Load Balancers](https://cloud.google.com/load-balancing/docs/l7-internal/setting-up-zonal-negs)<br> _ **Cross-region internal proxy Network Load Balancer** (`GCE_VM_IP_PORT` endpoints)<br> _ [Set up zonal and hybrid NEGs for cross-region internal proxy Network Load Balancers](https://cloud.google.com/load-balancing/docs/l7-internal/setting-up-hybrid-zonal-negs)<br> \* ...and others including Application Load Balancers, external proxy Network Load Balancers, and Cloud Service Mesh. |

---

## Internet NEG

| Features                                    | Details                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| :------------------------------------------ | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Purpose**                                 | A single internet-routable endpoint that is hosted outside of Google Cloud.<br>For detailed information, see [Internet NEGs overview](https://cloud.google.com/load-balancing/docs/negs/internet-neg-concepts).                                                                                                                                                                                                                                                                                                                           |
| **NetworkEndpointType API name**            | `INTERNET_IP_PORT`<br>IP:Port, where IP must not be an RFC 1918 address.<br><br>OR<br><br>`INTERNET_FQDN_PORT`<br>FQDN:Port                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Number of endpoints**                     | **Global NEGs:** 1<br>**Regional NEGs:** 256                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **Health checks**                           | **Global NEGs:** not supported<br>**Regional NEGs:** distributed Envoy health checks                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **Scope**                                   | Global or regional                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **Routing**                                 | Internet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **Google Cloud products that use this NEG** | _ **Global internet NEGs**<br> _ Cloud CDN: [Set up Cloud CDN with an external backend](https://cloud.google.com/cdn/docs/setting-up-external-backend)<br> _ External Application Load Balancer: [Set up a global external Application Load Balancer with an external backend](https://cloud.google.com/load-balancing/docs/l7-external/setting-up-gxlb-with-external-backend)<br> _ **Regional internet NEGs**<br> _ Regional external/internal Application Load Balancers<br> _ Regional external/internal proxy Network Load Balancers |

---

## Serverless NEG

| Features                                    | Details                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| :------------------------------------------ | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Purpose**                                 | A single endpoint within Google's network that resolves to an App Engine, Cloud Run, API Gateway, or Cloud Functions resource.<br>For detailed information, see [Serverless NEGs overview](https://cloud.google.com/load-balancing/docs/negs/serverless-neg-concepts).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **NetworkEndpointType API name**            | `SERVERLESS`<br>FQDN belonging to an App Engine, Cloud Run, API Gateway, or Cloud Functions resource.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **Number of endpoints**                     | 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **Health checks**                           | Not applicable                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **Scope**                                   | Regional                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Routing**                                 | To Google APIs and Services                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **Google Cloud products that use this NEG** | _ **External Application Load Balancer:**<br> _ [Set up with an App Engine, Cloud Run, or Cloud Functions backend](https://cloud.google.com/load-balancing/docs/l7-external/setting-up-gxlb-serverless)<br> _ **Internal Application Load Balancer** (Cloud Run & Cloud Functions 2nd gen only):<br> _ [Set up a regional internal Application Load Balancer with a Cloud Run backend](https://cloud.google.com/load-balancing/docs/l7-internal/setting-up-l7-ilb-serverless)<br> _ **Cross-region internal Application Load Balancer** (Cloud Run & Cloud Functions 2nd gen only):<br> _ [Set up a cross-region internal Application Load Balancer with a Cloud Run backend](https://cloud.google.com/load-balancing/docs/l7-internal/setting-up-cross-region-l7-ilb-serverless) |

---

## Hybrid connectivity NEG

| Features                                    | Details                                                                                                                                                                                                                                                                                                                                             |
| :------------------------------------------ | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Purpose**                                 | One or more endpoints that resolve to on-premises services, server applications in another cloud, and other internet-reachable services outside Google Cloud.                                                                                                                                                                                       |
| **NetworkEndpointType API name**            | `NON_GCP_PRIVATE_IP_PORT`<br>IP:Port belonging to a VM that is not in Compute Engine and that must be routable using hybrid connectivity.                                                                                                                                                                                                           |
| **Number of endpoints**                     | 1 or more                                                                                                                                                                                                                                                                                                                                           |
| **Health checks**                           | **Centralized health checks** for global/classic load balancers.<br>**Distributed Envoy health checks** for regional/cross-region Envoy-based load balancers.                                                                                                                                                                                       |
| **Scope**                                   | Zonal                                                                                                                                                                                                                                                                                                                                               |
| **Routing**                                 | To an on-premises network or another Cloud provider network by way of Cloud Interconnect, Cloud VPN, or Router appliance VM.                                                                                                                                                                                                                        |
| **Google Cloud products that use this NEG** | _ External Application Load Balancers<br> _ Internal Application Load Balancers<br> _ External proxy Network Load Balancers<br> _ Internal proxy Network Load Balancers<br> \* Cloud Service Mesh<br>For specific setup guides, see [Hybrid Connectivity NEG documentation](https://cloud.google.com/load-balancing/docs/negs/hybrid-neg-concepts). |

---

## Private Service Connect NEG

| Features                                    | Details                                                                                                                                                                                                                                                                                                                                                              |
| :------------------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Purpose**                                 | A single endpoint that resolves to a Google-managed regional/global API endpoint or a managed service published using Private Service Connect.                                                                                                                                                                                                                       |
| **NetworkEndpointType API name**            | `PRIVATE_SERVICE_CONNECT`                                                                                                                                                                                                                                                                                                                                            |
| **Number of endpoints**                     | 1                                                                                                                                                                                                                                                                                                                                                                    |
| **Health checks**                           | Not applicable                                                                                                                                                                                                                                                                                                                                                       |
| **Scope**                                   | Regional                                                                                                                                                                                                                                                                                                                                                             |
| **Routing**                                 | [Private Service Connect: Supported load balancers and targets](https://cloud.google.com/vpc/docs/private-service-connect#supported-configurations)                                                                                                                                                                                                                  |
| **Google Cloud products that use this NEG** | _ Cross-region/Regional internal Application Load Balancer<br> _ Global/Regional external Application Load Balancer<br> \* Global/Regional/Cross-region/Regional internal/external proxy Network Load Balancer<br>For more information, see [About Private Service Connect backends](https://cloud.google.com/load-balancing/docs/negs/private-service-connect-neg). |

---

## Port mapping NEG

| Features                                    | Details                                                                                                                                                                                                                                                                                                                   |
| :------------------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Purpose**                                 | One or more endpoints, each providing a mapping from a client port of a Private Service Connect endpoint to a combination of service port and service producer VM.<br>For detailed information, see [About Private Service Connect port mapping](https://cloud.google.com/vpc/docs/private-service-connect-port-mapping). |
| **NetworkEndpointType API name**            | `GCE_VM_IP_PORTMAP`                                                                                                                                                                                                                                                                                                       |
| **Number of endpoints**                     | 1 or more                                                                                                                                                                                                                                                                                                                 |
| **Health checks**                           | Not applicable                                                                                                                                                                                                                                                                                                            |
| **Scope**                                   | Regional                                                                                                                                                                                                                                                                                                                  |
| **Routing**                                 | To a service producer VPC network through a connection between a Private Service Connect endpoint and a service attachment.                                                                                                                                                                                               |
| **Google Cloud products that use this NEG** | Private Service Connect port mapping                                                                                                                                                                                                                                                                                      |
